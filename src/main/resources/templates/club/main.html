<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/layout}">
<th:block layout:fragment="content">
  <div class="sb-nav-fixed">
    <div id="layoutSidenav">
      <div id="layoutSidenav_nav">
        <nav class="sb-sidenav accordion sb-sidenav-light" id="sidenavAccordion">
          <div class="sb-sidenav-menu">
            <div class="nav">
              <div class="sb-sidenav-menu-heading d-flex justify-content-between align-items-center">
                <h5 class="mb-0">모임원</h5>
                <a class="btn btn-link btn-sm p-0" id="sidebarToggle" href="#!">
                  <svg viewBox="0 0 32 32" xmlns="http://www.w3.org/2000/svg" width="16" height="16">
                    <path class="cls-1"
                          d="M15.12,15.53,25,5.66a1,1,0,0,1,1.41,1.41l-9.06,9.06,8.8,8.8a1,1,0,0,1,0,1.41h0a1,1,0,0,1-1.42,0l-9.61-9.61A.85.85,0,0,1,15.12,15.53Z"/>
                    <path class="cls-1"
                          d="M5.54,15.53l9.88-9.87a1,1,0,1,1,1.41,1.41L7.77,16.13l8.8,8.8a1,1,0,0,1,0,1.41h0a1,1,0,0,1-1.41,0L5.54,16.73A.85.85,0,0,1,5.54,15.53Z"/>
                  </svg>

                </a>
              </div>
              <hr>


              <div th:each="member : ${userAndClubDTOS}" class="member-container">
                <img src="/assets/프로필.png" alt="회원 프로필 사진" class="profile-image clubMain">
                <div class="member-info">
                  <h6 class="sb-sidenav-menu" th:text="${member.userNo.userNickname}"></h6>
                </div>
              </div>
            </div>
          </div>
          <hr>
          <div th:if="${isMember == 2}">
            <a th:href="@{/club/update}" class="edit-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear"
                   viewBox="0 0 16 16">
                <path
                    d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0"/>
                <path
                    d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z"/>
              </svg>
              <p>설정</p>
            </a>
            <a th:href="@{/club/members}" class="edit-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                   class="bi bi-person-circle" viewBox="0 0 16 16">
                <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
                <path fill-rule="evenodd"
                      d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
              </svg>
              <p>맴버관리</p>
            </a>
            <a th:href="@{/club/disband-page}" class="edit-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ban"
                   viewBox="0 0 16 16">
                <path
                    d="M15 8a6.97 6.97 0 0 0-1.71-4.584l-9.874 9.875A7 7 0 0 0 15 8M2.71 12.584l9.874-9.875a7 7 0 0 0-9.874 9.874ZM16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0"/>
              </svg>
              <p>모임해산</p>
            </a>
          </div>
          <div th:unless="${isMember == 2}">
            <a th:href="@{/club/leave-page}" class="edit-link">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-ban"
                   viewBox="0 0 16 16">
                <path
                    d="M15 8a6.97 6.97 0 0 0-1.71-4.584l-9.874 9.875A7 7 0 0 0 15 8M2.71 12.584l9.874-9.875a7 7 0 0 0-9.874 9.874ZM16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0"/>
              </svg>
              <p>탈퇴하기</p>
            </a>
          </div>
          <div class="sb-sidenav-footer">
            <div class="sb-sidenav-footer-block"></div>
          </div>
        </nav>

      </div>
      <div id="layoutSidenav_content">

        <main>
          <div class="container-fluid" style="width: 80%">
            <div class="row">
              <div class="col-12 d-flex align-items-center">

                <img th:if="${#strings.contains(clubProfilePhoto, 'ClubDefaultPhoto')}"
                     class="club-cover" src="/assets/ClubDefaultPhoto.jpg">

                <img th:unless="${#strings.contains(clubProfilePhoto, 'ClubDefaultPhoto')}"
                     class="club-cover" th:src="@{/view/{photo}(photo=${clubProfilePhoto})}">

                <div class="club-info">
                  <h1 class="mt-4" th:text="${clubDTO.clubName}">모임명</h1>
                  <p th:text="${clubDTO.clubContent}">모임 소개</p>
                </div>
              </div>

              <form th:action="@{/club/update-Wish}" method="post">

                <input type="hidden" name="clubNo" th:value="${clubDTO.clubNo}"/>
                <input type="hidden" name="isWish" th:value="${isWish}"/>
                <div th:switch="${isWish}">
                  <button type="submit" style="float: right; border: none; background: none; padding-right: 1rem;"
                          th:case="'Y'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                         class="bi bi-star-fill" viewBox="0 0 16 16">
                      <path
                          d="M3.612 15.443c-.386.198-.824-.149-.746-.592l.83-4.73L.173 6.765c-.329-.314-.158-.888.283-.95l4.898-.696L7.538.792c.197-.39.73-.39.927 0l2.184 4.327 4.898.696c.441.062.612.636.282.95l-3.522 3.356.83 4.73c.078.443-.36.79-.746.592L8 13.187l-4.389 2.256z"/>
                    </svg>
                  </button>
                  <button type="submit" style="float: right; border: none; background: none; padding-right: 1rem;"
                          th:case="'N'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                         class="bi bi-star" viewBox="0 0 16 16">
                      <path
                          d="M2.866 14.85c-.078.444.36.791.746.593l4.39-2.256 4.389 2.256c.386.198.824-.149.746-.592l-.83-4.73 3.522-3.356c.33-.314.16-.888-.282-.95l-4.898-.696L8.465.792a.513.513 0 0 0-.927 0L5.354 5.12l-4.898.696c-.441.062-.612.636-.283.95l3.523 3.356-.83 4.73zm4.905-2.767-3.686 1.894.694-3.957a.56.56 0 0 0-.163-.505L1.71 6.745l4.052-.576a.53.53 0 0 0 .393-.288L8 2.223l1.847 3.658a.53.53 0 0 0 .393.288l4.052.575-2.906 2.77a.56.56 0 0 0-.163.506l.694 3.957-3.686-1.894a.5.5 0 0 0-.461 0z"/>
                    </svg>
                  </button>
                </div>

              </form>

            </div>
            <br>
            <hr>
            <br>
            <div class="row">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <h2>진행 중인 일정</h2>
                <a th:href="@{/schedule/create}">
                  <h5> + 일정추가</h5>
                </a>
              </div>
              <div class="row row-cols-1 row-cols-md-3 g-0">
                <div class="col-3" th:each="schedule, iterStat : ${getOngoingSchedules}">
                  <div class="card h-100 cardBody" th:classappend="${iterStat.index >= 3} ? 'd-none more-schedule'">
                    <a class="card-img-wrapper" th:href="@{/schedule/{scheduleNo}(scheduleNo = ${schedule.scheduleNo})}"
                       th:inline="text">

                      <div th:if="${#lists.size(ongoingSchedulePhotoList) > iterStat.index}">

                        <img
                            th:if="${#strings.contains(ongoingSchedulePhotoList[iterStat.index], 'ScheduleDefaultPhoto')}"
                            class="club-cover" src="/assets/ScheduleDefaultPhoto.jpg">

                        <!--                     TODO org.springframework.expression.spel.SpelEvaluationException: EL1025E: The collection has '0' elements, index '1' is invalid
                        -->
                        <img
                            th:unless="${#strings.contains(ongoingSchedulePhotoList[iterStat.index], 'ScheduleDefaultPhoto')}"
                            class="club-cover"
                            th:src="@{/view/{photo}(photo = ${ongoingSchedulePhotoList[iterStat.index]})}">

                      </div>
                    </a>
                    <div class="card-body">
                      <a class="link" th:href="@{/schedule/{scheduleNo}(scheduleNo = ${schedule.scheduleNo})}"
                         th:inline="text">
                        <h3 class="card-title truncate-title" th:text="${schedule.scheduleTitle}"></h3>
                      </a>
                      <p class="card-text" th:with="ampm=${#dates.format(schedule.scheduleStartDate, 'a')}"
                         th:text="${#dates.format(schedule.scheduleStartDate, 'M월 d일, ')} +
                         (${ampm == 'AM'} ? '오전' : '오후') +
                         ${#dates.format(schedule.scheduleStartDate, ' hh:mm')}">
                        일정 시작시간
                      </p>
                      <p class="card-text" th:text="${schedule.schedulePlace}">장소</p>
                    </div>
                  </div>
                </div>
              </div>
              <div class="text-center">
                <a class="load-more" href="#!">
                  <img src="/assets/더보기.png">
                </a>
              </div>
            </div>
            <hr>
            <br>
            <div class="row">
              <h2>마감된 일정</h2>
              <div class="row row-cols-1 row-cols-md-3 g-0">
                <div class="col-3" th:each="schedule, iterStat : ${endSchedules}">
                  <div class="card h-100 cardBody" th:classappend="${iterStat.index >= 3} ? 'd-none more-schedule'">
                    <a class="card-img-wrapper" th:href="@{/schedule/{scheduleNo}(scheduleNo = ${schedule.scheduleNo})}"
                       th:inline="text">

                      <img
                          th:if="${#lists.size(endSchedulePhotoList) > iterStat.index and #strings.contains(endSchedulePhotoList[iterStat.index], 'ScheduleDefaultPhoto')}"
                          class="club-cover" src="/assets/ScheduleDefaultPhoto.jpg">

                      <img th:if="${#lists.size(endSchedulePhotoList) > iterStat.index}"
                           th:unless="${#strings.contains(endSchedulePhotoList[iterStat.index], 'ScheduleDefaultPhoto')}"
                           class="club-cover" th:src="@{/view/{photo}(photo=${endSchedulePhotoList[iterStat.index]})}">


                      <!--                      <img src="/assets/일정.jpg" class="card-img schedule" alt="...">-->
                    </a>
                    <div class="card-body">
                      <a class="link" th:href="@{/schedule/{scheduleNo}(scheduleNo = ${schedule.scheduleNo})}"
                         th:inline="text">
                        <h3 class="card-title truncate-title" th:text="${schedule.scheduleTitle}"></h3>
                      </a>
                      <p class="card-text" th:with="ampm=${#dates.format(schedule.scheduleStartDate, 'a')}"
                         th:text="${#dates.format(schedule.scheduleStartDate, 'M월 d일, ')} +
                         (${ampm == 'AM'} ? '오전' : '오후') +
                         ${#dates.format(schedule.scheduleStartDate, ' hh:mm')}">
                        일정 시작시간
                      </p>
                      <p class="card-text" th:text="${schedule.schedulePlace}">장소</p>
                    </div>
                  </div>
                </div>
                <div class="text-center">
                  <a class="load-more" href="#!">
                    <img src="/assets/더보기.png">
                  </a>
                </div>
              </div>
            </div>
            <hr>
            <br>
            <div class="row">
              <div style="display: flex; align-items: center; justify-content: space-between;">
                <h2>후기</h2>
                <a th:href="@{/article/create}">
                  <h5> + 후기작성</h5>
                </a>
              </div>
              <div class="row row-cols-1 row-cols-md-4 g-0">
                <div class="row row-cols-1 row-cols-md-4 g-0">
                  <div class="col-3" th:each="article, iterStat : ${articles}">
                    <div class="card h-100 cardBody" th:classappend="${iterStat.index >= 4} ? 'd-none more-review'">
                      <a th:href="@{/article/{articleNo}(articleNo=${article.articleNo})}" th:inline="text">

                        <img
                            th:if="${#lists.size(articlePhotoList) > iterStat.index and #strings.contains(articlePhotoList[iterStat.index], 'NullPhoto')}"
                            class="club-cover" src="/assets/NullPhoto.png">

                        <img th:if="${#lists.size(articlePhotoList) > iterStat.index}"
                             th:unless="${#strings.contains(articlePhotoList[iterStat.index], 'NullPhoto')}"
                             class="club-cover" th:src="@{/view/{photo}(photo=${articlePhotoList[iterStat.index]})}">

                      </a>
                      <a th:href="@{/article/{articleNo}(articleNo=${article.articleNo})}" th:inline="text">
                        <h4 class="card-title" th:text="${article.articleTitle}">후기글 제목</h4>
                      </a>
                      <p class="card-text" th:text="${article.userNo.userNickname}"></p>
                    </div>
                  </div>
                </div>
                <div class="text-center">
                  <a class="load-more-review" href="#!">
                    <img src="/assets/더보기.png">
                  </a>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>
  </div>
</th:block>


    <!--

   사진 표기 부분 참고용 0731 YY

         <div class="row">
        <div th:if="${getOngoingSchedules!=null && getOngoingSchedules.size()>0}"
             th:with="onMaxIndex=${#lists.size(ongoingSchedulePhotoList) - 1}">
          <div class="col-4" th:each="i : ${#numbers.sequence(0, onMaxIndex)}">

                 <div class="col-4" th:each="schedule : ${getOngoingSchedules}">
  <div class="card mb-3" style="max-width: 415px;">
    <div class="row g-0">
      <div class="col-md-4">

        <img class="card-img-top" th:src="@{/view/{photo}(photo=${ongoingSchedulePhotoList[i]})}">
      </div>
      <div class="col-md-8">
        <div class="card-body">
          <a th:href="@{/schedule/{scheduleNo}(scheduleNo = ${getOngoingSchedules[i].scheduleNo})}"
             th:inline="text">
            <h3 class="card-title" th:text="${getOngoingSchedules[i].scheduleTitle}"></h3>
          </a>
          <p class="card-text"
             th:text="${#dates.format(getOngoingSchedules[i].scheduleStartDate,'yyyy년 MM월 dd일 HH:mm')}">일정
            시작시간</p>
          <p class="card-text" th:text="${getOngoingSchedules[i].schedulePlace}">장소</p>
          <p class="card-text"
             th:text="|${getOngoingSchedules[i].scheduleParticipants} / ${getOngoingSchedules[i].scheduleMax}|">
            참가인원</p>
        </div>
      </div>
    </div>
  </div>
       </div>
  </div>



   -->



<th:block layout:fragment="script">

  <script th:inline="javascript">
      document.addEventListener('DOMContentLoaded', function () {
          // 제목 길이 제한
          var titles = document.querySelectorAll('.truncate-title');
          titles.forEach(function (title) {
              if (title.textContent.length > 20) {
                  title.textContent = title.textContent.substr(0, 20) + '...';
              }
          });


      });
      // 스케줄 더보기 버튼 기능
      document.querySelectorAll('.load-more').forEach(button => {
          const hiddenSchedules = button.parentElement.previousElementSibling.querySelectorAll('.more-schedule');
          if (hiddenSchedules.length <= 3) {
              button.style.display = 'none';
          }
          button.addEventListener('click', function () {
              const hiddenSchedules = this.parentElement.previousElementSibling.querySelectorAll('.more-schedule.d-none');
              for (let i = 0; i < 3 && i < hiddenSchedules.length; i++) {
                  hiddenSchedules[i].classList.remove('d-none');
              }
              if (hiddenSchedules.length <= 3) {
                  this.style.display = 'none';
              }
          });
      });
      // 후기 더보기 버튼 기능
      document.querySelectorAll('.load-more-review').forEach(button => {
          const hiddenReviews = button.parentElement.previousElementSibling.querySelectorAll('.more-review');
          if (hiddenReviews.length <= 4) {
              button.style.display = 'none';
          }
          button.addEventListener('click', function () {
              const hiddenReviews = this.parentElement.previousElementSibling.querySelectorAll('.more-review.d-none');
              for (let i = 0; i < 4 && i < hiddenReviews.length; i++) {
                  hiddenReviews[i].classList.remove('d-none');
              }
              if (hiddenReviews.length <= 4) {
                  this.style.display = 'none';
              }
          });
      });
      document.addEventListener('DOMContentLoaded', function () {
          const sidebarToggle = document.body.querySelector('#sidebarToggle');
          const sidebarToggleHeader = document.body.querySelector('#sidebarToggle-header');

          function toggleSidebar() {
              document.body.classList.toggle('sb-sidenav-toggled');
              localStorage.setItem('sb|sidebar-toggle', document.body.classList.contains('sb-sidenav-toggled'));

              if (document.body.classList.contains('sb-sidenav-toggled')) {
                  sidebarToggleHeader.style.display = 'block';
              } else {
                  sidebarToggleHeader.style.display = 'none';
              }
          }

          if (sidebarToggle) {
              sidebarToggle.addEventListener('click', function (event) {
                  event.preventDefault();
                  toggleSidebar();
              });
          }

          if (sidebarToggleHeader) {
              sidebarToggleHeader.addEventListener('click', function (event) {
                  event.preventDefault();
                  toggleSidebar();
              });
          }
      });
  </script>

</th:block>

</html>