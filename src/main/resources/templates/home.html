
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout/layout.html"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
>

<th:block layout:fragment="content">

  <!--  news / 공지사항 출력 부분 -->
  <br>
  <table class="table" style="width: 50%; margin: auto" >
    <thead>
    <tr class="card-title">
      <th colspan="5" style="margin: auto; text-align: center">모모 공지사항</th>
      <th sec:authorize="hasRole('ADMIN')"></th>
    </tr>
    <tr>
      <th scope="col">체크</th>
      <th scope="col">말머리</th>
      <th scope="col">제목</th>
      <th scope="col">등록일</th>
      <th scope="col">수정</th>
      <th scope="col" sec:authorize="hasRole('ADMIN')">delete</th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="news, rowStat : ${newsList}" th:scope="row">
      <td><input type="checkbox" name="select"></td>
      <td th:text="${news.newsTag}"></td>
      <td>
        <a style="text-decoration: none; color: black"
           th:href="@{/news/read/{newsNo}(newsNo=${news.newsNo})}"
           th:text="${news.newsTitle}">
        </a>
      </td>
      <td th:text="${news.newsModifyDate != null} ? ${#dates.format(news.newsModifyDate, 'yyyy-MM-dd HH:mm')} : ${#dates.format(news.newsCreateDate, 'yyyy-MM-dd HH:mm')}">
      <td>수정칸</td>
      <td sec:authorize="hasRole('ADMIN')">
        <form action="/news/delete/" method="post">
          <input type="hidden" name="newsNo" th:value="${news.newsNo}">
          <button type="submit" class="btn btn-danger">삭제하기</button>
        </form>
      </td>
    </tr>

    </tbody>
  </table>

  <br>

  <div class="container">
    <!-- 로그인한 사용자에게만 보이는 부분 -->
    <div class="row" th:if="${userNickname}">
      <p th:text="${userNickname + '님 어서오세요!'}">userNickname님 어서오세요!</p>
    </div>
  </div>

  <br>

  <h2>나의 모임</h2>
  <div class="row">

    <div th:if="${myClubDTOList!=null && myClubDTOList.size()>0}"
         th:with="myMaxIndex=${#lists.size(myClubDTOList) - 1}">
      <div>

        <div class="card mb-3" style="max-width: 415px;" th:each="i : ${#numbers.sequence(0, myMaxIndex)}">
          <div class="row g-0">


            <div class="col-md-3">

              <img th:if="${#strings.contains(myClubPhotoList[i], 'ClubDefaultPhoto')}" class="card-img-top"
                   src="/assets/ClubDefaultPhoto.jpg">

              <img th:unless="${#strings.contains(myClubPhotoList[i], 'ClubDefaultPhoto')}" class="card-img-top"
                   th:src="@{/view/{photo}(photo=${myClubPhotoList[i]})}">

            </div>


            <div class="col-md-8">
              <div class="card-body">
                <a th:href="@{/club/main/{clubNo}(clubNo = ${myClubDTOList[i].clubNo})}"
                   th:inline="text">
                  <h3 class="card-title" th:text="${myClubDTOList[i].clubName}"></h3>
                </a>
                <p class="card-text" th:text="${myClubDTOList[i].clubContent}"></p>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>

  <hr>

  <div class="row">
    <div>
      <button class="btn btn-primary" th:unless="${#authentication.name == 'anonymousUser'}"
              th:onclick="|location.href='@{/club/create}'|">생성
      </button>
    </div>
  </div>

  <div class="row-cols-auto">

    <div th:if="${ clubDTOList.size()>0}" th:with="maxIndex=${#lists.size(clubDTOList) - 1}">
      <div th:each="i : ${#numbers.sequence(0, maxIndex)}">
        <div class="card mb-3" style="max-width: 415px;">
          <div class="row g-0">

            <div class="col-md-4">

              <img th:if="${#strings.contains(clubPhotoList[i], 'ClubDefaultPhoto')}" class="card-img-top"
                   src="/assets/ClubDefaultPhoto.jpg">

              <img th:unless="${#strings.contains(clubPhotoList[i], 'Default')}" class="card-img-top"
                   th:src="@{/view/{photo}(photo=${clubPhotoList[i]})}">

            </div>

            <div class="col-md-8">
              <div class="card-body">
                <a th:href="@{/club/main/{clubNo}(clubNo = ${clubDTOList[i].clubNo})}" th:inline="text">
                  <h3 class="card-title" th:text="${clubDTOList[i].clubName}"></h3>
                </a>
                <p th:text="${clubDTOList[i].clubContent}"></p>
              </div>
            </div>

          </div>
        </div>
    </div>
    </div>
  </div>

<br>

</th:block>