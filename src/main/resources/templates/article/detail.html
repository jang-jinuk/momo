<!DOCTYPE html>
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="layout/layout">

<head>Article Detail</head>

<th:block layout:fragment="content">
    <div class="container" style="width: 850px">
        <div class="row">
            <div class="col-10"></div>
            <div class="col-2">
                <button type="button" th:onclick="|location.href='@{/club/main/{clubNo}(clubNo =${clubNo})}'|">모임 홈</button>
            </div>
        </div>
        <div class="row">
            <h2 th:text="${articleDTO.articleTitle}">제목</h2>
            <p th:text="${articleDTO.articleContent}">내용</p>

            <input type="hidden" name="_method" value="delete" />
            <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}" />
        </div>
        <div class="row">
            <div class="col-8"></div>
            <div class="col-4">
                <button type="button" th:onclick="|location.href='@{/article/update/{articleNo}(articleNo=${articleDTO.articleNo})}'|">수정</button>
                <button type="button" onclick="confirmDelete()">삭제</button>
            </div>
        </div>
        <div class="row"> <!-- 댓글 입력창 부분 -->

            <form id="articleReplyForm" action="/reply/create" method="post">
                <div>
                    <label for="replyContent">Reply Content:</label>
                    <textarea id="replyContent" name="replyContent" required></textarea>
                </div>
                <div>
                    <button class="btn btn-outline-primary" type="submit">댓글 등록</button>
                </div>
                <input type="hidden" name="articleNo.articleNo" th:value="${articleDTO.articleNo}">
            </form>

        </div>
        <div class="row"> <!-- 댓글 표시 부분 -->
            <div class="reply" th:each="reply : ${replyList}">
                <hr>
                <span th:text="${reply.getReplyContent()}"></span>
                <span th:text="'작성일 : ' + ${#dates.format(reply.getReplyCreateDate(), 'yy-MM-dd HH:mm')}"></span>
                <span th:text="'좋아요 수 : ' + ${reply.getReplyLikeNumber()}"></span>
                <span>작성자필요<!--TODO--></span>
                <!-- <button class="btn btn-outline-success modifyBtn">수정하기</button> -->
                <form id="replyDeleteForm" action="/reply/delete" method="post">
                    <input type="hidden" name="replyNo" th:value="${reply.getReplyNo()}"/>
                    <button type="submit" class="btn btn-outline-danger deleteBtn">삭제하기</button>
                </form>
            </div>

        </div>
    </div>
</th:block>
<th:block layout:fragment="script">
    <script th:inline="javascript">
        function confirmDelete() {
            if (confirm("정말 삭제하시겠습니까?")) {
                location.href = /*[[@{/article/delete/{articleNo}(articleNo=${articleDTO.articleNo})}]]*/ '';
            }
        }
    </script>
</th:block>